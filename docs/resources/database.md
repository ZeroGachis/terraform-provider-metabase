---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "metabase_database Resource - terraform-provider-metabase"
subcategory: ""
description: |-
  A database Metabase can connect to. Currently only BigQuery has a dedicated attribute, but any engine can be set up using the custom_details attribute.
  The configuration of this resource requires passing sensitive credentials to the Metabase API. Those credentials will also be stored in the Terraform state. Ensure those values are not checked into a repository nor are being displayed during Terraform operations.
---

# metabase_database (Resource)

A database Metabase can connect to. Currently only BigQuery has a dedicated attribute, but any engine can be set up using the custom_details attribute.

The configuration of this resource requires passing sensitive credentials to the Metabase API. Those credentials will also be stored in the Terraform state. Ensure those values are not checked into a repository nor are being displayed during Terraform operations.

## Example Usage

```terraform
resource "metabase_database" "bigquery" {
  name = "üóÉÔ∏è Big Query"

  bigquery_details = {
    service_account_key      = file("sa-key.json")
    project_id               = "gcp-project"
    dataset_filters_type     = "inclusion"
    dataset_filters_patterns = "included_dataset"
  }
}

resource "metabase_database" "imported" {
  name = "‚¨áÔ∏è Imported"

  bigquery_details = {
    # If you don't have access to the service account key, you can use the redacted value to ensure there is no diff
    # when importing the resource. If you do have a key, a one-time apply will be needed to reset the key.
    service_account_key      = "**MetabasePass**"
    project_id               = "gcp-project"
    dataset_filters_type     = "exclusion"
    dataset_filters_patterns = "excluded_dataset"
  }
}

# If an engine is not supported by the provider, you can also set a raw configuration that will be passed through to the
# Metabase API.
resource "metabase_database" "custom" {
  name = "üîß Custom"

  custom_details = {
    engine = "postgres"

    details_json = jsonencode({
      host                    = "127.0.0.1"
      port                    = 5432
      dbname                  = "database"
      user                    = "user"
      password                = "password"
      schema-filters-type     = "inclusion"
      schema-filters-patterns = "this_schema_only"
      ssl                     = false
      tunnel-enabled          = false
      advanced-options        = false
    })

    # Details attributes redacted by Metabase should be listed here, such that they are not incorrectly detected as a
    # change.
    redacted_attributes = [
      "password",
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The user-displayable name for the database.

### Optional

- `bigquery_details` (Attributes) Connection details when setting up a BigQuery database. (see [below for nested schema](#nestedatt--bigquery_details))
- `custom_details` (Attributes) Connection details when setting up a database which is not supported by this provider. (see [below for nested schema](#nestedatt--custom_details))

### Read-Only

- `id` (Number) The ID for the database.

<a id="nestedatt--bigquery_details"></a>
### Nested Schema for `bigquery_details`

Required:

- `service_account_key` (String, Sensitive) The content of the service account key file.

Optional:

- `dataset_filters_patterns` (String) The pattern used by the `dataset-filters-type`.
- `dataset_filters_type` (String) The behavior of how BigQuery datasets should be selected. Can be `inclusion`, `exclusion`, or `all`.
- `project_id` (String) The ID of the GCP project containing the BigQuery datasets.


<a id="nestedatt--custom_details"></a>
### Nested Schema for `custom_details`

Required:

- `details_json` (String) The details for the database, as a JSON string. `jsonencode` can be used for clarity.
- `engine` (String) The name of the engine, as defined by Metabase.

Optional:

- `redacted_attributes` (Set of String) The list of `details_json` attributes that are sent back redacted by Metabase.

## Import

Import is supported using the following syntax:

```shell
# Use the integer ID from the Metabase API.
terraform import metabase_database.db 1
```
